openapi: 3.1.0
info:
  title: Pledger.io
  description: Pledger.io is a self-hosted personal finance application that helps
    you track your income and expenses.
  contact:
    name: Jong Soft Development
    url: https://github.com/pledger-io/rest-application
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  version: 4.0.0
security:
- bearer: []
- bearerAuth: []
tags:
- name: i18n
  description: i18n
- name: account-fetcher
  description: Operations to fetch account information
- name: account-commands
  description: Operations to manipulate account information
- name: transaction-fetcher
  description: Operations to fetch transaction information
paths:
  /:
    get:
      operationId: index
      responses:
        "200":
          description: index 200 response
          content:
            application/json:
              schema: {}
  /favicon.ico:
    get:
      operationId: favicon
      responses:
        "200":
          description: favicon 200 response
          content:
            application/json:
              schema: {}
  /ui:
    get:
      operationId: index_1
      responses:
        "200":
          description: index_1 200 response
          content:
            text/html:
              schema: {}
  /ui/assets/{path}:
    get:
      operationId: getAsset
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: getAsset 200 response
          content:
            application/json:
              schema: {}
  /ui/favicon.ico:
    get:
      operationId: favicon_1
      responses:
        "200":
          description: favicon_1 200 response
          content:
            application/json:
              schema: {}
  /ui/images/{path}:
    get:
      operationId: getImage
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: getImage 200 response
          content:
            application/json:
              schema: {}
  /ui/logo192.png:
    get:
      operationId: logo
      responses:
        "200":
          description: logo 200 response
          content:
            application/json:
              schema: {}
  /ui/logo512.png:
    get:
      operationId: logo_512
      responses:
        "200":
          description: logo_512 200 response
          content:
            application/json:
              schema: {}
  /ui/manifest.json:
    get:
      operationId: manifest
      responses:
        "200":
          description: manifest 200 response
          content:
            application/json:
              schema: {}
  /ui/{path}:
    get:
      operationId: catchAll
      parameters:
      - name: path
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: catchAll 200 response
          content:
            text/html:
              schema: {}
  /.well-known/openid-connect:
    get:
      tags:
      - open-id
      summary: Get configuration
      description: |
        Get the configuration needed to setup an OpenId integration in the front-end.
      operationId: openIdConfiguration
      responses:
        "200":
          description: The configuration
          content:
            application/json:
              schema:
                $ref: ./components/open-id-configuration.yaml
      security: []
  /.well-known/public-key:
    get:
      tags:
      - security
      summary: Get JWT signature
      description: |
        Get the public key used to verify the JWT signature.
      operationId: getJwtSignature
      responses:
        "200":
          description: The public key
          content:
            application/json:
              schema:
                type: string
      security: []
  /v2/api/user-account:
    post:
      tags:
      - security
      summary: Create user
      operationId: createUser
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/user-request"
      responses:
        "204":
          description: Confirmation the account was created
        "400":
          $ref: "#/components/responses/400"
      security: []
  /v2/api/user-account/verify-2-factor:
    post:
      tags:
      - security
      summary: Verify 2-factor
      description: |
        Used to verify the user token against that what is expected. If valid the user will get a new JWT with updated authorizations.
      operationId: verifyTwoFactor
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/token-request"
      responses:
        "200":
          description: Confirmation the 2 factor was OK
          content:
            application/json:
              schema:
                type: object
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/user-account/{user}:
    get:
      tags:
      - profile
      summary: Get profile
      description: |
        Get the profile of the authenticated user
      operationId: getProfile
      responses:
        "200":
          description: The users profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/user-profile-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    patch:
      tags:
      - profile
      summary: Update profile
      description: |
        Update a part of the users profile
      operationId: patchProfile
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                theme:
                  type: string
                  example: dark
                currency:
                  type: string
                  example: EUR
                password:
                  type: string
      responses:
        "200":
          description: The users profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/user-profile-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: user
      in: path
      required: true
      schema:
        type: string
        example: e@example.nl
  /v2/api/user-account/{user}/sessions:
    get:
      tags:
      - profile
      summary: List sessions
      description: |
        Retrieve a list of all active sessions of the user
      operationId: listSessions
      responses:
        "200":
          description: A list of the users session
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/session-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - profile
      summary: Create session
      description: |
        Start a new durable long term session. This can for example be used in a mobile app.
      operationId: createSession
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/session-request"
      responses:
        "201":
          description: The created session
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/session-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: user
      in: path
      required: true
      schema:
        type: string
        example: e@example.nl
  /v2/api/user-account/{user}/sessions/{session}:
    delete:
      tags:
      - profile
      summary: Revoke session
      description: |
        Revoke a session. This will disable any future use of the session in any app.
      operationId: revokeSession
      responses:
        "204":
          description: Confirmation the session is deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: user
      in: path
      required: true
      schema:
        type: string
        example: e@example.nl
    - name: session
      in: path
      required: true
      schema:
        type: integer
        example: 123
  /v2/api/user-account/{user}/2-factor:
    get:
      tags:
      - profile
      summary: Create QR code
      description: |
        Get the QR-code that can be used to active the 2-factor authentication.
      operationId: generateQrCode
      responses:
        "200":
          description: The content of the file
          content:
            '*/*':
              schema:
                type: string
                format: byte
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    patch:
      tags:
      - profile
      summary: Update 2-factor
      description: |
        Enable or disable the 2-factor authentication  for the user.
      operationId: patch2Factor
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/patch-multi-factor-request"
      responses:
        "204":
          description: Confirmation that the command was executed
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: user
      in: path
      required: true
      schema:
        type: string
        example: e@example.nl
  /v2/api/i18n/{languageCode}:
    get:
      tags:
      - i18n
      summary: Get i18n
      operationId: getTranslations
      parameters:
      - name: languageCode
        in: path
        required: true
        schema:
          type: string
          example: en
      responses:
        "200":
          description: getTranslations 200 response
          content:
            application/json:
              schema:
                $ref: ./components/i18n-response.yaml
      security: []
  /v2/api/currencies:
    get:
      tags:
      - currency
      summary: Search currencies
      operationId: getCurrencies
      responses:
        "200":
          description: The list of currencies
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/currency-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - currency
      summary: Create currency
      operationId: createCurrency
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/currency-request"
      responses:
        "201":
          description: The created currency
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/currency-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/currencies/{currencyCode}:
    get:
      tags:
      - currency
      summary: Fetch currency
      operationId: getCurrencyByCode
      responses:
        "200":
          description: The currency
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/currency-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    put:
      tags:
      - currency
      summary: Update currency
      operationId: updateCurrencyByCode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/currency-request"
      responses:
        "200":
          description: The updated currency
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/currency-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    patch:
      tags:
      - currency
      summary: Patch currency
      operationId: patchCurrencyByCode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/patch-currency-request"
      responses:
        "200":
          description: The updated currency
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/currency-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: currencyCode
      in: path
      description: The currency code
      required: true
      schema:
        type: string
        example: EUR
  /v2/api/settings:
    get:
      tags:
      - settings
      summary: Fetch settings
      operationId: getAllSettings
      responses:
        "200":
          description: The list of currencies
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/setting-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/settings/{setting}:
    patch:
      tags:
      - settings
      summary: Update setting
      operationId: patchSetting
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/setting-request"
      responses:
        "204":
          description: Confirmation the setting was updated
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: setting
      in: path
      description: The setting name
      required: true
      schema:
        type: string
  /v2/api/files:
    post:
      tags:
      - files
      summary: Create file
      operationId: uploadFile
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                upload:
                  type: string
                  format: binary
        required: true
      responses:
        "201":
          description: The file code for the created file
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/file-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/files/{fileCode}:
    get:
      tags:
      - files
      summary: Download file
      description: |
        Download an existing file from the system. If encryption is enabled this will throw an exception if the file was not uploaded by the user  downloading it.
      operationId: downloadFile
      responses:
        "200":
          description: The content of the file
          content:
            '*/*':
              schema:
                type: string
                format: byte
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - files
      summary: Delete file
      operationId: deleteFile
      responses:
        "204":
          description: Confirmation the file was removed
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: fileCode
      in: path
      required: true
      schema:
        type: string
  /v2/api/runtime-engine/{processDefinition}:
    get:
      tags:
      - process-engine
      summary: Historic instances
      description: |
        Lists the historic executions for the provided process definition key
      operationId: getProcessInstances
      responses:
        "200":
          description: A list of process instances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/process-instance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - process-engine
      summary: Start process
      description: |
        Starts a new process instance for the provided process definition key
      operationId: startProcessInstance
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties:
                type: object
      responses:
        "201":
          description: The created process instance
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/process-instance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}:
    get:
      tags:
      - process-engine
      summary: History by business key
      description: |
        List the history executions for the provided definition key,  but only once with matching business key
      operationId: getProcessInstancesByBusinessKey
      responses:
        "200":
          description: A list of process instances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/process-instance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/business-key"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}:
    get:
      tags:
      - process-engine
      summary: Fetch process instance
      operationId: getProcessInstance
      responses:
        "200":
          description: The process instance
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/process-instance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    delete:
      tags:
      - process-engine
      summary: Delete process instance
      operationId: deleteProcessInstance
      responses:
        "204":
          description: A confirmation that the process instance was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/instance-id"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}/tasks:
    get:
      tags:
      - task-engine
      summary: Search tasks for process
      operationId: getTasks
      responses:
        "200":
          description: A list of tasks for the process instance
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/task-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/instance-id"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}/tasks/{taskId}:
    get:
      tags:
      - task-engine
      summary: Fetch task
      operationId: getTaskById
      responses:
        "200":
          description: The updated task
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/task-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    post:
      tags:
      - task-engine
      summary: Complete task
      operationId: completeTask
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/task-variable-map"
      responses:
        "204":
          description: A confirmation that task was completed
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    delete:
      tags:
      - task-engine
      summary: Delete task
      operationId: deleteTask
      responses:
        "204":
          description: A confirmation that task was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/instance-id"
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/task-id"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}/tasks/{taskId}/variables:
    get:
      tags:
      - task-engine
      summary: Fetch task variables
      operationId: getTaskVariables
      parameters:
      - name: variable
        in: query
        schema:
          type: string
      responses:
        "200":
          description: A map of all named variables of this task
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/task-variable-map"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/instance-id"
    - $ref: "#/components/parameters/task-id"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}/variables:
    get:
      tags:
      - variable-engine
      summary: Fetch process variables
      operationId: getVariables
      responses:
        "200":
          description: A list of variables for the process instance
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/variable-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/instance-id"
  /v2/api/runtime-engine/{processDefinition}/{businessKey}/{instanceId}/variables/{variableId}:
    get:
      tags:
      - variable-engine
      summary: Fetch variable
      operationId: getVariableById
      responses:
        "200":
          description: The variable contents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/variable-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/403"
    parameters:
    - $ref: "#/components/parameters/process-definition"
    - $ref: "#/components/parameters/business-key"
    - $ref: "#/components/parameters/instance-id"
    - $ref: "#/components/parameters/variable-id"
  /v2/api/account-types:
    get:
      tags:
      - system-information
      summary: Get account types
      description: |
        Get a listing of all available account types in the system.
      operationId: getAccountTypes
      responses:
        "200":
          description: A list of all available account types
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/export:
    get:
      tags:
      - export
      summary: Export profile
      description: |
        Create an export of all information that belongs to the authenticated user.
      operationId: exportUserAccount
      responses:
        "200":
          description: The JSON of the export
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/export-profile-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/accounts:
    get:
      tags:
      - account-fetcher
      summary: Search accounts
      description: |
        List available accounts that the current user has access to
      operationId: getAccounts
      parameters:
      - name: type
        in: query
        description: The account type to filter on
        schema:
          type: array
          items:
            type: string
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/number-of-results"
      - name: accountName
        in: query
        description: A partial name of an account to look for
        schema:
          type: string
      responses:
        "200":
          description: The list of accounts
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/paged-account-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - account-command
      summary: Create account
      description: |
        Create a new account for the current user
      operationId: createAccount
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/account-request"
      responses:
        "201":
          description: The created account
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/account-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/accounts/top-by-spending:
    get:
      tags:
      - account-fetcher
      summary: Top account by spending
      description: |
        Returns the top spending accounts for the current user within the optional date range. You can filter by account type or include only your own accounts using useOwnAccounts. The response is an array ordered by highest spending, each item providing account and amount details.
      operationId: getTopAccountsBySpending
      parameters:
      - $ref: "#/components/parameters/start-date"
      - $ref: "#/components/parameters/end-date"
      - name: type
        in: query
        description: Filter on the type of account. Must not be set when useOwnAccounts
          is provided.
        schema:
          $ref: "#/components/schemas/account-type"
      - name: useOwnAccounts
        in: query
        description: Filter on all of the users own accounts. If set the type filter
          will be ignored.
        schema:
          type: boolean
      responses:
        "200":
          description: The list of top spending accounts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/account-spending-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/accounts/{id}:
    get:
      tags:
      - account-fetcher
      summary: Get account
      description: |
        Get account details by id for the current user
      operationId: getAccountById
      responses:
        "200":
          description: The created account
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/account-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          description: Saving goal not found
    put:
      tags:
      - account-command
      summary: Update account
      description: |
        Update account details by id for the current user
      operationId: updateAccountById
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/account-request"
      responses:
        "200":
          description: The created account
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/account-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          description: Saving goal not found
    delete:
      tags:
      - account-command
      summary: Delete account
      description: |
        Delete account details by id for the current user
      operationId: deleteAccountById
      responses:
        "204":
          description: Confirmation that the account was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the account
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/accounts/{id}/saving-goals:
    get:
      tags:
      - account-fetcher
      summary: List saving goals
      description: |
        Get the saving goals for the account, note this can only be called if the account type is SAVINGS.
      operationId: getSavingGoalsForAccount
      responses:
        "200":
          description: The list of saving goals
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/saving-goal-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    post:
      tags:
      - account-command
      summary: Create saving goal
      description: |
        Create a new saving goal for the account, note this can only be called if the account type is SAVINGS.
      operationId: createSavingGoalForAccount
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/saving-goal-request"
      responses:
        "201":
          description: The created saving goal
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/saving-goal-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: id
      in: path
      description: The identifier of the account
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/accounts/{id}/saving-goals/{goalId}:
    put:
      tags:
      - account-command
      summary: Update saving goal
      description: |
        Update a saving goal for the account, note this can only be called if the account type is SAVINGS.
      operationId: updateSavingGoalForAccount
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/saving-goal-request"
      responses:
        "200":
          description: The updated saving goal
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/saving-goal-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    delete:
      tags:
      - account-command
      summary: Delete saving goal
      description: |
        Remove a saving goal for the account, note this can only be called if the account type is SAVINGS.
      operationId: deleteSavingGoalForAccount
      responses:
        "204":
          description: Confirmation that the saving goal was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the account
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
    - name: goalId
      in: path
      description: The identifier of the saving goal
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/accounts/{id}/saving-goals/{goalId}/make-reservation:
    post:
      tags:
      - account-command
      summary: Reserve money saving goal
      description: |
        Make a reservation for the saving goal, note this can only be called if the account type is SAVINGS.
      operationId: makeReservationForSavingGoal
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/saving-reservation-request"
      responses:
        "204":
          description: Confirmation that a reservation was added to the saving goal
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the account
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
    - name: goalId
      in: path
      description: The identifier of the saving goal
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/transactions:
    get:
      tags:
      - transaction-fetcher
      summary: Search transactions
      description: |
        Search the current user's transactions using optional filters such as date range, account, budget/expense, category, contract, tags, description text, type, import id, and currency. Results are returned as a paged list that can be navigated with offset and number-of-results parameters.
      operationId: findTransactionBy
      parameters:
      - $ref: "#/components/parameters/start-date"
      - $ref: "#/components/parameters/end-date"
      - $ref: "#/components/parameters/number-of-results"
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/account-filter"
      - $ref: "#/components/parameters/expense-filter"
      - $ref: "#/components/parameters/category-filter"
      - $ref: "#/components/parameters/contract-filter"
      - $ref: "#/components/parameters/tag-filter"
      - $ref: "#/components/parameters/import-id-filter"
      - name: description
        in: query
        description: Filter on a part of the transaction description
        schema:
          type: string
      - name: type
        in: query
        description: Filter on the transaction type
        schema:
          type: string
          enum:
          - INCOME
          - EXPENSE
          - TRANSFER
      - name: currency
        in: query
        description: Filter based on the currency code
        schema:
          type: string
          example: EUR
          maxLength: 3
          minLength: 3
      responses:
        "200":
          $ref: "#/components/responses/paged-transaction"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - transaction-command
      summary: Create transaction
      description: Create a new transaction in the system
      operationId: createTransaction
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/transaction-request"
      responses:
        "201":
          description: The created transaction
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/transactions/{id}:
    get:
      tags:
      - transaction-fetcher
      summary: Fetch transaction
      description: Fetch a single transaction from the system
      operationId: getTransactionById
      responses:
        "200":
          description: The matching transaction
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    put:
      tags:
      - transaction-command
      summary: Update transaction
      description: Update a transaction in the system
      operationId: updateTransaction
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/transaction-request"
      responses:
        "200":
          description: The updated transaction
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - transaction-command
      summary: Delete transaction
      description: Remove a transaction from the system
      operationId: deleteTransaction
      responses:
        "204":
          description: Confirmation that a transaction was removed
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    patch:
      tags:
      - transaction-command
      summary: Split transaction
      description: Provide the new split for the transaction
      operationId: splitTransaction
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  description:
                    type: string
                  amount:
                    type: number
      responses:
        "200":
          description: The updated transaction
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the transaction
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/balance:
    post:
      tags:
      - statistics-balance
      summary: Compute balance
      description: |
        Computes a balance for the user based on the filters applied.
      operationId: computeBalanceWithFilter
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/balance-request"
      responses:
        "200":
          description: The balance for the given filters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/balance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/balance/{partition}:
    post:
      tags:
      - statistics-balance
      summary: Compute partitioned balance
      description: |
        Computes a balance for the user based on the filters applied.
      operationId: computePartitionedBalanceWithFilter
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/balance-request"
      responses:
        "200":
          description: The balance for the given filters
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/partitioned-balance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: partition
      in: path
      required: true
      schema:
        type: string
        enum:
        - account
        - budget
        - category
  /v2/api/balance/by-date/{type}:
    post:
      tags:
      - statistics-balance
      summary: Compute date partitioned balance
      description: |
        Computes the balance grouping it by date as indicated in the `type`.
      operationId: computeBalanceGroupedByDate
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/balance-request"
      responses:
        "200":
          description: The balance for the given filters
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/dated-balance-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: type
      in: path
      required: true
      schema:
        type: string
        enum:
        - daily
        - monthly
  /v2/api/detected/insight:
    get:
      tags:
      - insight
      summary: Fetch insights
      description: |
        Retrieve detected financial insights for a given year and optional month. Returns an array of insights for the current user.
      operationId: getInsightsByFilters
      parameters:
      - name: year
        in: query
        schema:
          type: integer
          min: 1990
          max: 9999
      - name: month
        in: query
        schema:
          type: integer
          min: 1
          max: 12
      responses:
        "200":
          description: The list of detected insights
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/insight-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/detected/pattern:
    get:
      tags:
      - insight
      summary: Fetch patterns
      description: |
        Retrieve detected spending patterns for a given year and optional month. Returns an array of patterns for the current user.
      operationId: getPatternsByFilters
      parameters:
      - name: year
        in: query
        schema:
          type: integer
          min: 1990
          max: 9999
      - name: month
        in: query
        schema:
          type: integer
          min: 1
          max: 12
      responses:
        "200":
          description: The list of detected patterns
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/pattern-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/categories:
    get:
      tags:
      - category-fetcher
      summary: Search categories
      description: |
        Retrieve a paged list of categories that match the optional name filter. Use offset and number-of-results to paginate through the result set.
      operationId: findCategoriesBy
      parameters:
      - $ref: "#/components/parameters/name-filter"
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/number-of-results"
      responses:
        "200":
          description: The categories matching the filters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/paged-category-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - category-command
      summary: Create category
      description: |
        Create a new category using the provided request body. Returns the created category with its generated identifier and details.
      operationId: createCategory
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/category-request"
      responses:
        "201":
          description: The created category
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/category-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/categories/{id}:
    get:
      tags:
      - category-fetcher
      summary: Fetch category
      description: |
        Retrieve a single category by its identifier. Returns the full category details if it exists and the user has access.
      operationId: getCategoryById
      responses:
        "200":
          description: The category
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/category-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    put:
      tags:
      - category-command
      summary: Update category
      description: |
        Update an existing category identified by its id using the provided request body. Returns the updated category details.
      operationId: updateCategory
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/category-request"
      responses:
        "200":
          description: The updated category
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/category-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - category-command
      summary: Delete category
      description: |
        Delete a category by its identifier. On success, a 204 No Content is returned to confirm removal.
      operationId: deleteCategoryById
      responses:
        "204":
          description: Confirmation that a transaction was removed
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the category
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/contracts:
    get:
      tags:
      - contract-fetcher
      summary: Search contracts
      description: |
        Retrieve contracts filtered by optional name and status (ACTIVE or INACTIVE). Returns a list of matching contracts for the current user.
      operationId: findContractBy
      parameters:
      - $ref: "#/components/parameters/name-filter"
      - name: status
        in: query
        schema:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
      responses:
        "200":
          description: The contracts matching the filters
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/contract-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - contract-command
      summary: Create contract
      description: Create a new contract in the application.
      operationId: createContract
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contract-request"
      responses:
        "201":
          description: The created contract
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contract-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/contracts/{id}:
    get:
      tags:
      - contract-fetcher
      summary: Fetch contract
      description: Fetch a single contract by its unique identifier.
      operationId: getContractById
      responses:
        "200":
          description: The contract
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contract-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    put:
      tags:
      - contract-command
      summary: Update contract
      description: Update an existing contract in the application.
      operationId: updateContract
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contract-request"
      responses:
        "200":
          description: The updated category
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contract-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - contract-command
      summary: Delete contract
      description: Marks a contract that it is no longer relevant in the application.
      operationId: deleteContractById
      responses:
        "204":
          description: Confirmation that a contract was removed
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the contract
      required: true
      schema:
        type: integer
        format: int64
        example: 1234567890
  /v2/api/contracts/{id}/warn-before-expiration:
    post:
      tags:
      - contract-command
      summary: Warn before end
      description: Send out a warning e-mail before the contract expiry date
      operationId: warnBeforeContractExpiry
      responses:
        "204":
          description: Confirmation that a contract was removed
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the contract
      required: true
      schema:
        type: integer
        format: int64
        example: 123
  /v2/api/tags:
    get:
      tags:
      - tag-fetcher
      summary: Search tags
      description: |
        Return a list of tag names matching the optional name filter for the current user.
      operationId: findTagsBy
      parameters:
      - $ref: "#/components/parameters/name-filter"
      responses:
        "200":
          description: The tags matching the filters
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - tag-command
      summary: Create tag
      description: |
        Create a new tag with the given name for the current user. Returns 204 on success.
      operationId: createTag
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
      responses:
        "204":
          description: Confirmation the tag was created
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/tags/{tag}:
    delete:
      tags:
      - tag-command
      summary: Delete tag
      description: |
        Delete an existing tag by its name. Returns 204 on success; if the tag does not exist, a 404 may be returned.
      operationId: deleteTag
      responses:
        "204":
          description: Confirmation the tag was deleted
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    parameters:
    - name: tag
      in: path
      required: true
      schema:
        type: string
  /v2/api/schedules:
    get:
      tags:
      - schedule-fetcher
      summary: Search schedules
      description: |
        List transaction schedules matching optional filters on account and contract. Returns all schedules the current user has access to.
      operationId: findScheduleByFilter
      parameters:
      - name: account
        in: query
        description: |
          Identifiers of accounts to filter for. Can be either a source or destination for the schedule.
        schema:
          type: array
          items:
            type: integer
      - name: contract
        in: query
        description: |
          Identifiers of contracts to filter on.
        schema:
          type: array
          items:
            type: integer
      responses:
        "200":
          description: The list of schedules based upon the filters
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/transaction-schedule-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - schedule-command
      summary: Create schedule
      description: |
        Create a new transaction schedule using the provided request body. Returns the created schedule including its identifier and configuration.
      operationId: createSchedule
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/schedule-request"
      responses:
        "201":
          description: Confirmation the schedule was created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-schedule-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/schedules/{id}:
    get:
      tags:
      - schedule-fetcher
      summary: Fetch schedule
      description: |
        Retrieve a single transaction schedule by its identifier. Returns full details of the schedule if found.
      operationId: findScheduleById
      responses:
        "200":
          description: The schedule
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-schedule-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - schedule-command
      summary: Delete schedule
      description: |
        Delete a transaction schedule by its identifier. Returns 204 on successful deletion.
      operationId: deleteSchedule
      responses:
        "204":
          description: Confirmation the schedule was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    patch:
      tags:
      - schedule-command
      summary: Update schedule
      description: |
        Partially update an existing transaction schedule using the provided patch request. Returns the updated schedule.
      operationId: updateSchedule
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/schedule-patch-request"
      responses:
        "200":
          description: The updated schedule
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/transaction-schedule-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: id
      in: path
      description: The identifier of the schedule
      required: true
      schema:
        type: integer
        format: int64
        example: 123
  /v2/api/batch-importer:
    get:
      tags:
      - batch-importer
      summary: Search import jobs
      operationId: getJobsByFilters
      parameters:
      - $ref: "#/components/parameters/number-of-results"
      - $ref: "#/components/parameters/offset"
      responses:
        "200":
          description: The batch jobs that were executed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/paged-batch-job-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - batch-importer
      summary: Create import job
      operationId: createJob
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                configuration:
                  type: string
                fileToken:
                  type: string
      responses:
        "201":
          description: The created batch job
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/batch-job-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/batch-importer/{slug}:
    get:
      tags:
      - batch-importer
      summary: Get import job
      operationId: getJobBySlug
      responses:
        "200":
          description: The batch job
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/batch-job-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    delete:
      tags:
      - batch-importer
      summary: Delete import job
      operationId: deleteJobBySlug
      responses:
        "204":
          description: Confirmation that the batch job was deleted
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    parameters:
    - name: slug
      in: path
      description: The unique identifier
      required: true
      schema:
        type: string
  /v2/api/batch-importer-config:
    get:
      tags:
      - batch-importer
      summary: Search configuration
      operationId: getConfigurations
      responses:
        "200":
          description: A list of all available configurations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/configuration-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - batch-importer
      summary: Create configuration
      operationId: createConfiguration
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: The name of the configuration
                type:
                  type: string
                  description: The type of importer that will be used
                fileCode:
                  type: string
                  description: The file code to get the contents of the configuration
              required:
              - fileCode
              - name
              - type
      responses:
        "201":
          description: THe created configuration
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/configuration-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
  /v2/api/budgets:
    get:
      tags:
      - budget-fetcher
      summary: Search budgets
      description: |
        Retrieve budget periods for the authenticated user. You can filter by year and/or month. When firstOnly is true, only the first matching budget period is returned.
      operationId: findByFilter
      parameters:
      - name: year
        in: query
        description: The year to get the budget for
        required: false
        schema:
          type: int
      - name: month
        in: query
        description: The month to get the budget for
        required: false
        schema:
          type: int
          min: 1
          max: 12
      - name: firstOnly
        in: query
        description: "If true, only the first budget will be returned."
        schema:
          type: boolean
      responses:
        "200":
          description: The list of matching budget periods
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/budget-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    post:
      tags:
      - budget-command
      summary: Create budget
      description: |
        Create the initial budget for the current user. This can only be called once if no budget exists for the current user.
      operationId: createInitialBudget
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/budget-request"
      responses:
        "201":
          description: The created budget
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/budget-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
    patch:
      tags:
      - budget-command
      summary: Update budget
      description: |
        Update the current budget for the current user. This operation will also index all expenses based upon the difference between the previous expected income and the new expected income.
      operationId: updateCurrentBudget
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/budget-request"
      responses:
        "200":
          description: The created budget
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/budget-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
  /v2/api/budgets/expenses:
    get:
      tags:
      - budget-fetcher
      summary: Search expenses
      description: |
        Search expenses within the currently active budget for the authenticated user. You can provide a partial name to filter the results. Returns the matching expenses.
      operationId: findExpensesByFilter
      parameters:
      - name: name
        in: query
        description: Filter expenses based upon the partial name
        schema:
          type: string
      responses:
        "200":
          description: The found expenses
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/expense-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
    patch:
      tags:
      - budget-command
      summary: Update expense
      description: |
        Create or update an expense under the current active budget.
      operationId: updateExpense
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/expense-request"
      responses:
        "200":
          description: The updated budget
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/budget-response"
        "400":
          $ref: "#/components/responses/400"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
  /v2/api/budgets/expenses/balance:
    get:
      tags:
      - budget-fetcher
      summary: Compute expense balance
      description: |
        Compute the budget-vs-spending balance for one month of the authenticated user. Provide year and month to select the period. Optionally pass one or more expenseId values to limit the calculation to specific expenses. Returns the computed balance per expense for the selected period.
      operationId: computeBudgetExpenseBalance
      parameters:
      - name: year
        in: query
        description: The year to get the budget for
        required: true
        schema:
          type: int
      - name: month
        in: query
        description: The month to get the budget for
        required: true
        schema:
          type: int
          min: 1
          max: 12
      - name: expenseId
        in: query
        description: Optional list of expense identifiers to filter on
        schema:
          type: array
          items:
            type: integer
            format: int64
      responses:
        "200":
          description: The current balance
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/computed-expense-response"
        "401":
          $ref: "#/components/responses/401"
        "403":
          $ref: "#/components/responses/403"
        "404":
          $ref: "#/components/responses/404"
components:
  schemas:
    date-range:
      $ref: components/date-range.yaml
    token-request:
      $ref: ./components/requests/token.yaml
    user-request:
      $ref: ./components/requests/user.yaml
    currency-request:
      $ref: ./components/requests/currency.yaml
    setting-request:
      $ref: ./components/requests/setting.yaml
    patch-currency-request:
      $ref: ./components/requests/patch-currency.yaml
    patch-multi-factor-request:
      $ref: ./components/requests/patch-multi-factor.yaml
    session-request:
      $ref: ./components/requests/session.yaml
    currency-response:
      $ref: ./components/responses/currency.yaml
    setting-response:
      $ref: ./components/responses/setting.yaml
    file-response:
      $ref: ./components/responses/file.yaml
    user-profile-response:
      $ref: ./components/responses/user-profile.yaml
    session-response:
      $ref: ./components/responses/session.yaml
    enable-mfa-request:
      type: object
      properties:
        verificationCode:
          type: string
          min: 4
          max: 8
        action:
          type: string
      required:
      - action
      - verificationCode
    disable-mfa-request:
      type: object
      properties:
        action:
          type: string
      required:
      - action
    process-instance-response:
      $ref: components/process-instance.yaml
    task-response:
      $ref: components/task.yaml
    variable-response:
      $ref: components/variable-response.yaml
    task-variable-map:
      type: object
      format: TaskVariableMap
    variable:
      $ref: components/variable.yaml
    periodicity:
      $ref: components/periodicity.yaml
    account-type:
      $ref: components/account-type.yaml
    account-link:
      $ref: components/account-link.yaml
    account-request:
      $ref: components/requests/account.yaml
    saving-goal-request:
      $ref: components/requests/saving-goal.yaml
    saving-reservation-request:
      $ref: components/requests/saving-reservation.yaml
    transaction-request:
      $ref: components/requests/transaction.yaml
    category-request:
      $ref: components/requests/category.yaml
    contract-request:
      $ref: components/requests/contract.yaml
    schedule-request:
      $ref: components/requests/create-schedule.yaml
    schedule-patch-request:
      $ref: components/requests/patch-schedule.yaml
    balance-request:
      $ref: components/requests/balance.yaml
    account-response:
      $ref: components/responses/account.yaml
    account-spending-response:
      $ref: components/responses/account-spending.yaml
    schedule-response:
      $ref: components/responses/schedule.yaml
    paged-response:
      $ref: components/paged-response.yaml
    paged-account-response:
      $ref: components/responses/paged-account.yaml
    saving-goal-response:
      $ref: components/responses/saving-goal.yaml
    json-error-response:
      $ref: components/responses/json-error.yaml
    transaction-response:
      $ref: components/responses/transaction.yaml
    paged-transaction-response:
      $ref: components/responses/paged-transaction.yaml
    category-response:
      $ref: components/responses/category.yaml
    paged-category-response:
      $ref: components/responses/paged-category.yaml
    contract-response:
      $ref: components/responses/contract.yaml
    paged-contract-response:
      $ref: components/responses/paged-contract.yaml
    transaction-schedule-response:
      $ref: components/responses/transaction-schedule.yaml
    export-profile-response:
      $ref: components/responses/export-profile.yaml
    balance-response:
      $ref: components/responses/balance.yaml
    partitioned-balance-response:
      $ref: components/responses/partitioned-balance.yaml
    dated-balance-response:
      $ref: components/responses/dated-balance.yaml
    insight-response:
      $ref: components/responses/insight.yaml
    pattern-response:
      $ref: components/responses/pattern.yaml
    batch-job-response:
      $ref: components/batch-job.yaml
    paged-batch-job-response:
      $ref: components/paged-batch-job.yaml
    configuration-response:
      $ref: components/configuration.yaml
    budget-request:
      $ref: components/requests/budget.yaml
    expense-request:
      $ref: components/requests/expense.yaml
    budget-response:
      $ref: components/responses/budget.yaml
    expense-response:
      $ref: components/responses/expense.yaml
    computed-expense-response:
      $ref: components/responses/computed-expense.yaml
  responses:
    "400":
      $ref: ./responses/400-response.yaml
    "401":
      $ref: ./responses/401-response.yaml
    "403":
      $ref: ./responses/403-response.yaml
    "404":
      $ref: ./responses/404-response.yaml
    paged-transaction:
      $ref: ./responses/paged-transactions.yaml
  parameters:
    business-key:
      $ref: ./parameters/business-key.yaml
    instance-id:
      $ref: ./parameters/instance-id.yaml
    process-definition:
      $ref: ./parameters/process-definition.yaml
    variable-id:
      $ref: ./parameters/variable-id.yaml
    task-id:
      $ref: ./parameters/task-id.yaml
    number-of-results:
      $ref: parameters/number-of-results.yaml
    offset:
      $ref: parameters/offset.yaml
    start-date:
      $ref: parameters/startDate.yaml
    end-date:
      $ref: parameters/endDate.yaml
    account-filter:
      $ref: parameters/accounts.yaml
    expense-filter:
      $ref: parameters/budgets.yaml
    category-filter:
      $ref: parameters/categories.yaml
    contract-filter:
      $ref: parameters/contracts.yaml
    tag-filter:
      $ref: parameters/tags.yaml
    import-id-filter:
      $ref: parameters/import-id.yaml
    name-filter:
      $ref: parameters/name.yaml
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
      bearerFormat: JWT
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
